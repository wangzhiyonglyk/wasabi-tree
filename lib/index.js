!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("prop-types"),require("react"),require("wasabi-api")):"function"==typeof define&&define.amd?define(["prop-types","react","wasabi-api"],t):"object"==typeof exports?exports["wasabi-tree"]=t(require("prop-types"),require("react"),require("wasabi-api")):e["wasabi-tree"]=t(e["prop-types"],e.react,e["wasabi-api"])}(self,((e,t,n)=>(()=>{"use strict";var r={99:t=>{t.exports=e},156:e=>{e.exports=t},313:e=>{e.exports=n}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return r[e](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.apply(this,arguments)}o.r(l),o.d(l,{default:()=>be});var t=o(156),n=o.n(t);function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,l,i=[],c=!0,d=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){d=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(d)throw a}}return i}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var c=o(99),d=o.n(c),s=o(313),u=o.n(s);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function p(e){var t=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===f(t)?t:String(t)}function h(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){var t;if("object"===f(e))if(null===e)t=null;else if(e instanceof Array){t=[];for(var n=0;n<e.length;n++)t.push(b(e[n]))}else if(e instanceof Date)t=new Date(e.valueOf());else if(e instanceof Map)t=new Map(e);else if(e instanceof Set)t=new Set(e);else for(var r in t={},e)t[r]=b(e[r]);else t=e;return t}function g(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")}function m(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pId",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text",a=[],o={},l=0,i="",c="",d=0;d<e.length;d++){var s;c+=","+(null!==(s=e[d][t])&&void 0!==s?s:"")+","}for(var u=0;u<e.length;u++){var f,p;c.indexOf(","+(null!==(f=e[u][n])&&void 0!==f?f:"")+",")<=-1&&(i+=","+(null!==(p=e[u][n])&&void 0!==p?p:"")+",")}for(var h=0;0!==e.length&&l<2e6;){var y,b;if(l++,i.indexOf(","+(null!==(y=e[h][n])&&void 0!==y?y:"")+",")>-1||null===(b=e[h][n])||void 0===b||!b){var g,m,k,D,C=v(v({},e[h]),{},{id:null!==(g=e[h][t])&&void 0!==g?g:"",pId:null!==(m=e[h][n])&&void 0!==m?m:"",text:e[h][r],children:null!==(k=null===(D=e[h])||void 0===D?void 0:D.children)&&void 0!==k?k:[]});a.push(C),o[e[h][t]]=[a.length-1],C._path=[a.length-1],e.splice(h,1),h--}else{var A,x=o[null!==(A=e[h][n])&&void 0!==A?A:""];if(x){for(var w,O,I,E=a[x[0]],S=1;S<x.length;S++)E=E.children[x[S]];var N=v(v({},e[h]),{},{id:e[h][t],pId:null!==(w=e[h][n])&&void 0!==w?w:"",text:e[h][r],children:null!==(O=null===(I=e[h])||void 0===I?void 0:I.children)&&void 0!==O?O:[]});E.children.push(N),o[e[h][t]]=x.concat([E.children.length-1]),N._path=o[e[h][t]],e.splice(h,1),h--}}++h>e.length-1&&(h=0)}return e.length>0&&console.error("数据格式不正确，或者是数据量过大，请使用异步请求"),a}function k(e){var t=[];if(e&&e instanceof Array)for(var n=0;n<e.length;n++)e[n]._isLast=n===e.length-1,t.push(e[n]),e[n].children&&e[n].children.length>0&&!0===e[n].isOpened&&(t=t.concat(k(e[n].children)));return t}function D(e,t,n){try{if(Array.isArray(t))return function(e,t){var n=null;try{if(e&&e.length>0&&t&&t.length>0&&(n=e[t[0]],t&&t.length>1))for(var r=1;r<t.length;r++)n.children&&n.children.length>0&&(n=n.children[t[r]])}catch(e){console.error("findNodeByPath",e)}return n}(t,function(e,t){return e&&e.get(t)}(e,n))}catch(e){console.error("findNodeById",e)}return null}function C(e,t){var n=[];try{if(Array.isArray(e)&&Array.isArray(t)&&(n=[e[t[0]]],t&&t.length>1))for(var r=1;r<t.length;r++)n[n.length-1].children&&n[n.length-1].children.length>0&&n.push(n[n.length-1].children[t[r]])}catch(e){console.error("findLinkNodesByPath",e)}return n}function A(e,t,n,r,a){try{if(Array.isArray(t)){var o=D(e,t,n);o&&(o.isChecked=!!r,(r&&a&&a.y&&a.y.indexOf("s")>-1||!r&&a&&a.n&&a.n.indexOf("s")>-1)&&(o=w(o,o.isChecked)),(o.isChecked&&a&&a.y&&a.y.indexOf("p")>-1||!o.isChecked&&a&&a.n&&a.n.indexOf("p")>-1)&&function(e){try{if(e&&e.length>1)for(var t=e.length-2;t>=0;t--)if(e[t].children&&e[t].children.length>0){for(var n=0,r=0,a=0;a<e[t].children.length;a++)e[t].children[a].isChecked&&n++,e[t].children[a].half&&r++;n===e[t].children.length?(e[t].isChecked=!0,e[t].half=!1):n>0&&n!==e[t].children.length||r>0?(e[t].isChecked=!1,e[t].half=!0):(e[t].isChecked=!1,e[t].half=!1)}}catch(e){console.error("setNodeParentsChecked",e)}}(C(t,o._path)))}}catch(e){console.error("setChecked",e)}return t}function x(e,t,n,r,a){try{if(Array.isArray(t)){var o=D(e,t,n);if(o)if("all"===a)t=I(t),o.isChecked=r,o.half=!1;else if("level"===a){var l=C(t,o._path);if(l&&l.length>=2){var i=l[l.length-2];if(i.children&&i.children.length>0)for(var c=0;c<i.children.length;c++)i.children[c].isChecked=!1,i.children[c].half=!1}else if(l&&1===l.length){for(var d=0;d<t.length;d++)t[d].isChecked=falsedata[d].half=!1;l&&l.length>0&&(l[l.length-1].isChecked,l[l.length-1].half=!1)}}}}catch(e){console.log("setRadioChecked",e)}return t}function w(e,t){try{if(e.isChecked=t,e.half=!1,Array.isArray(e.children))for(var n=0;n<e.children.length;n++)e.children[n]=w(e.children[n],t)}catch(e){console.error("setNodeChildrenChecked",e)}return e}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{if(Array.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];r.isChecked&&(t.push(r),Array.isArray(r.children)&&O(r.children,t))}}catch(e){console.error("getChecked",e)}return t}function I(e){try{if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];n.isChecked=!1,n.half=!1,Array.isArray(n.children)&&I(n.children)}}catch(e){}return e}function E(e){if(e&&e instanceof Array&&e.length>0){for(var t=0;t<e.length;t++)e[t].isChecked=!0,e[t].half=!1,e[t].children&&e[t].children.length>0&&(e[t].children=E(e[t].children));return e}}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;try{if(Array.isArray(t)){var r=D(e,t,n);if(r){var a=C(t,r._path);a&&a.length>0&&a.forEach((function(e){e.isOpened=!0}))}}}catch(e){console.log("setLinkNodeOpen",e)}return t}function N(e,t,n){try{if(Array.isArray(t)){var r=D(e,t,n);if(r){var a=C(t,r._path);if(1===a.length)try{return t.splice(a[0]._path[0],1),e.delete(a[0].id),F(e,"",[],t)}catch(e){console.error("removeNode",a)}else{var o=a[a.length-2];o.children.splice(r._path[r._path.length-1],1),e.delete(a[0].id),T(e,r.children),o.children=F(e,o.id,o._path,o.children)}return t}}}catch(e){console.error("removeNode",e)}return t}function T(e,t){Array.isArray(t)&&t.forEach((function(t){e.delete(t.id),T(e,t.children)}))}function R(e,t,n,r,a){if(!Array.isArray(t))return[r];var o=D(e,t,n);if(o){var l,i,c=null!==(l=null==a?void 0:a.textField)&&void 0!==l?l:"text";for(var d in r)"id"!==d&&"pId"!==d&&(o[d]=r[d]);return o.text=r[c],Array.isArray(null!==(i=r[null==a?void 0:a.childrenField])&&void 0!==i?i:r.children)&&(o.children=F(e,o.id,o._path,r.children,a)),t}return t}function j(e,t,n,r,a){try{var o,l;n=D(e,t,null===(o=n)||void 0===o?void 0:o.id);var i=C(t,(r=D(e,t,null===(l=r)||void 0===l?void 0:l.id))._path);n&&r&&i&&n.pId!==r.id&&0===i.filter((function(e){return e.id===n.id})).length?(t=N(e,t,n.id),r.isOpened=!0,r.children.unshift(n),r.children=F(e,r.id,r._path,r.children,a)):console.log("停靠的节点不能是移动节点的父节点或者停靠的节点不能是移动节点的子节点")}catch(e){console.error("moveInNode",e)}return t}function B(e,t,n,r,a){return _(e,t,n,r,a,0)}function P(e,t,n,r,a){return _(e,t,n,r,a,1)}function _(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;try{var l,i;n=D(e,t,null===(l=n)||void 0===l?void 0:l.id);var c=C(t,(r=D(e,t,null===(i=r)||void 0===i?void 0:i.id))._path);if(n&&r&&c&&0===c.filter((function(e){return e.id===n.id})).length)if(t=N(e,t,n.id),1===c.length){var d=t.slice(0,r._path[0]+o),s=t.slice(r._path[0]+o,t.length);n.pId="",n._path=r._path[0]+o,d.push(n),t=F(e,"",[],t=[].concat(d,s),a)}else{var u=c[c.length-2],f=u.children.slice(0,leafDropNode._path[0]+o),p=u.children.slice(leafDropNode._path[0]+o,u.children.length);n.pId="",n._path=leafDropNode._path[0]+o,f.push(n),u.children=[].concat(f,p),u.children=F(e,u.id,u._path,u.children,a)}else console.log("停靠的节点不能是移动节点的子节点")}catch(e){console.error("moveBeforeOrAfterNode",e)}return t}function F(){var e,t,n,o,l,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map,c=arguments.length>1?arguments[1]:void 0,d=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0,f=null!==(e=null==u?void 0:u.idField)&&void 0!==e?e:"id",p=null!==(t=null==u?void 0:u.parentField)&&void 0!==t?t:"pId",h=null!==(n=null==u?void 0:u.textField)&&void 0!==n?n:"text",y=null!==(o=null==u?void 0:u.childrenField)&&void 0!==o?o:"children";!c&&null!=u&&u.isSimpleData&&(s=m(s,f,p,h));try{if(Array.isArray(s)){for(var v=0;v<s.length;v++){var b=[].concat(function(e){if(Array.isArray(e))return r(e)}(l=d)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(l)||a(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[v]);try{s[v]._path=b,s[v].pId=c,s[v]._isLast=v===s.length-1,s[v].id=s[v][f],s[v].text=s[v][h],i.set(s[v].id,b)}catch(e){console.log("setChildrenPath",e)}Array.isArray(s[v][y])&&(s[v].children=F(i,s[v].id,b,s[v][y],u))}return s}}catch(e){console.error("setChildrenPath",e)}return[]}const H={rowDefaultHeight:30,bufferScale:1};function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e,t,n){var r=e.current,a=t.payload,o=!1;switch(t.type){case"onChecked":o=a.id+""==a.checkValue+"","checkbox"===a.checkStyle?r.data=A(r.hashData,r.data,a.id,o,a.checkType):"radio"===a.checkstyle&&(r.data=x(r.hashData,r.data,a.id,o,a.radioType));break;case"onRename":r.data=function(e,t,n,r,a){if(Array.isArray(t)){var o=D(e,t,n);o&&(o.text=r,o[null==a?void 0:a.textField]=r)}return t}(r.hashData,r.data,a.id,a.newText,a.options);break;case"onRemove":r.data=N(r.hashData,r.data,a.id,a.options),r.flatData=k(r.data);break;case"onDrop":"in"===a.dragType?r.data=j(r.hashData,r.data,a.dragNode,a.dropNode,a.options):"before"===a.dragType?r.data=B(r.hashData,r.data,a.dragNode,a.dropNode,a.options):"after"===a.dragType&&(r.data=P(r.hashData,r.data,a.dragNode,a.dropNode,a.options)),r.flatData=k(r.data);break;case"filter":""!==(null!=a?a:"").toStrng()&&(r.filterData=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=[];n=(null!==(t=n)&&void 0!==t?t:"").toString().trim();try{if(n)for(var a=0;a<e.length;a++){var o=null;(e[a].text+"").indexOf(n)>-1&&((o=e[a]).isOpened=!0,r.push(o))}}catch(e){}return[]}(r.flatData,a));break;case"setOpen":r.data=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];try{if(Array.isArray(t)){var o=D(e,t,n);if(o){if(a&&r){var l=C(t,o._path),i=[];i=l&&l.length>1?l[l.length-2].children:t;for(var c=0;c<i.length;c++)i[c].isOpened=!r}r?S(e,t,o.id):o.isOpened=r}}}catch(e){console.error("setOpen",e)}return t}(r.hashData,r.data,a.id,a.isOpened,a.foldBroAble),r.flatData=k(r.data);break;case"setChecked":a.id&&("checkbox"===a.checkStyle?r.data=A(r.hashData,r.data,a.id,!!a.isChecked,a.checkType):"radio"===a.checkStyle&&(r.data=x(r.hashData,r.data,a.id,!!a.isChecked,a.radioType)));break;case"clearChecked":r.data=I(r.data);break;case"checkedAll":r.data=E(r.data);break;case"append":r.data=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;try{if(Array.isArray(r)){var o=D(e,t,n),l=r.filter((function(t){var n;return!e.has(null!==(n=t[null==a?void 0:a.idField])&&void 0!==n?n:null==t?void 0:t.id)}));if(o){var i;o.isOpened=!0;var c=null!==(i=o.children)&&void 0!==i?i:[];return c=c.concat(l),o.children=c,o.children=F(e,o.id,o._path,o.children,a),t}if(null===n||""===n||void 0===n)return F(e=new Map,"",[],r,a)}}catch(e){console.log("append",e)}}(r.hashData,r.data,a.pId,a.children,a.options),r.flatData=k(r.data);break;case"remove":Array.isArray(a.ids)?a.ids.forEach((function(e){r.data=N(r.hashData,r.data,e,a.options)})):r.data=N(r.hashData,r.data,a.ids,a.options),r.flatData=k(r.data);break;case"removeAll":r.data=nullIcurrent.filterData=null,r.hashData=new Map;break;case"update":Array.isArray(a.nodes)?a.nodes.forEach((function(e){r.data=R(r.hashData,r.data,e.id,e,a.options)})):r.data=R(r.hashData,r.data,a.nodes.id,a.nodes,a.options),r.flatData=k(r.data);break;case"updateAll":r.hashData=new Map,r.data=a.options.isSimpleData?m(a.data,a.options.idField,a.options.parentField,a.options.textField):a.data,r.data=F(r.hashData,"",[],r.data,a.options),r.flatData=k(r.data);break;case"moveIn":r.data=j(r.hashData,r.data,{id:a.dragId},{id:a.dropId},a.options),r.flatData=k(r.data);break;case"moveBefore":r.data=B(r.hashData,r.data,{id:a.dragId},{id:a.dropId},a.options),r.flatData=k(r.data);break;case"moveAfter":r.data=P(r.hashData,r.data,{id:a.dragId},{id:a.dropId},a.options),r.flatData=k(r.data);break;case"setLinkOpen":n({type:"update",payload:{gobalData:e}}),r.data=S(r.hashData,r.data,a),r.flatData=k(r.data)}n&&(clearTimeout(r.asyncAction),r.asyncAction=setTimeout((function(){n({type:"update",payload:{gobalData:e}})}),10))}function U(e){var t=[];try{t=e.filterData?e.filterData.slice(e.visibleDataArgs.sliceBeginIndex,e.visibleDataArgs.sliceEndIndex):e.flatData.slice(e.visibleDataArgs.sliceBeginIndex,e.visibleDataArgs.sliceEndIndex)}catch(e){}return t}var q,J;function K(e,t){try{var n;if(q===t)return J;q=t;var r=t.payload,a=null==r||null===(n=r.gobalData)||void 0===n?void 0:n.current;switch(t.type){case"loading":J=M(M({},e),{},{loadingId:r.loadingId});break;case"onClick":case"onDoubleClick":J=M(M({},e),{},{clickId:r});break;case"showVisibleData":case"update":J=M(M({},e),{},{visibleData:U(a)});break;case"selectNode":J=M(M({},e),{},{clickId:r.id,scrollIndex:{index:a.flatData.findIndex((function(e){return e.id===r.id}))}})}return J}catch(e){console.log("reduce error",e)}return e}const Y=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];if(n&&n instanceof Array&&n.length>0)for(var a=0;a<n.length;a++)if((","+t+",").indexOf(","+(n[a].value+""||n[a].id+"")+",")>-1&&r.push(n[a].text),n[a].children&&n[a].children.length>0){var o=e(t,n[a].children);r=[].concat(o,r)}return r||[]};var $=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=!1;return t&&(","+t.toString()+",").indexOf(","+e.value+",")>-1&&(n=!0),n};function z(e,r){var a=this,o=i((0,t.useState)(e.value),2),l=o[0],c=o[1],d=(0,t.useMemo)((function(){return Y(l,e.data).join(",")}),[e.data,l]);(0,t.useEffect)((function(){var t;c((null!==(t=e.value)&&void 0!==t?t:"")+"")}),[e]),(0,t.useImperativeHandle)(r,(function(){return{setValue:function(e){c(e)},getValue:function(){return l}}}));var s=e.data,u=e.half,f=e.readOnly,p=(0,t.useCallback)((function(t,n,r,a,o){if(!e.readOnly)if(""!==t){var l=a.toString()||"",i=o||"";if(l=l?l.split(","):[],i=i?i.split(","):[],l.indexOf(t.toString())>-1)try{l.splice(l.indexOf(t.toString()),1),i.splice(i.indexOf(n.toString()),1)}catch(e){}else l.push(t+""),i.push(n+"");c(l.join(",")),e.onSelect&&e.onSelect(l.join(","),i.join(","),e.name,r)}else c(""),e.onSelect&&e.onSelect("","",e.name,r)}),[e]);return s&&s instanceof Array&&s.length>0?n().createElement("div",{className:"wasabi-form-group "+(e.className||"")},n().createElement("div",{className:"wasabi-form-group-body"+(e.readOnly||e.disabled?" readOnly":"")},n().createElement("ul",{className:"wasabi-checkul"},s.map((function(e,t){var r,o,i=$(e,l);return n().createElement("li",{key:t,onClick:p.bind(a,null!==(r=e.value)&&void 0!==r?r:"",null!==(o=e.text)&&void 0!==o?o:"",e,l,d)},n().createElement("label",{className:"checkbox-label "+(i?" checked ":" ")+(u?" halfcheck ":""),readOnly:f}),n().createElement("div",{className:"checktext "+(i?" checked":""),readOnly:f},e.text))}))))):null}const G=n().memo(n().forwardRef(z));function Q(e,r){var a=this,o=i((0,t.useState)(e.value),2),l=o[0],c=o[1];(0,t.useEffect)((function(){c(e.value)}),[e]);var d=(0,t.useCallback)((function(t,n,r){c(t),e.onSelect&&e.onSelect(t,n,r)}),[e]);(0,t.useImperativeHandle)(r,(function(){return{setValue:function(e){c(e)},getValue:function(){return l}}}));var s=e.data,u=e.readOnly;if(s&&s instanceof Array&&s.length>0){var f="wasabi-radio-btn "+(u?" readOnly":"");return n().createElement("div",{className:"wasabi-form-group "+(e.className||"")},n().createElement("div",{className:"wasabi-form-group-body"+(e.readOnly||e.disabled?" readOnly":"")},n().createElement("ul",{className:"wasabi-checkul"},s.map((function(e,t){var r,o;return n().createElement("li",{key:t},n().createElement("div",{className:f+((null!=l?l:"")+""==(null!==(r=e.value)&&void 0!==r?r:"")+""?" checkedRadio":""),onClick:d.bind(a,e.value,e.text,e)},n().createElement("i",null)),n().createElement("div",{className:"radiotext "+(u?" readOnly":"")+((null!=l?l:"")+""==(null!==(o=e.value)&&void 0!==o?o:"")+""?" checkedRadio":""),onClick:d.bind(a,e.value,e.text,e)},e.text))})))))}return null}const W=n().memo(n().forwardRef(Q));function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function ee(e,t,n){return t&&Z(e.prototype,t),n&&Z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e,t){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ne(e,t)}function re(e){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},re(e)}const ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(o,e);var t,r,a=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=re(t);if(r){var a=re(this).constructor;e=Reflect.construct(n,arguments,a)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return te(e)}(this,e)});function o(e){var t;return X(this,o),(t=a.call(this,e)).state={oldPropsValue:null,value:t.props.value||""},t.onChange=t.onChange.bind(te(t)),t.keyUpHandler=t.keyUpHandler.bind(te(t)),t.blurHandler=t.blurHandler.bind(te(t)),t.getValue=t.getValue.bind(te(t)),t.setValue=t.setValue.bind(te(t)),t}return ee(o,[{key:"getValue",value:function(){return this.state.value}},{key:"setValue",value:function(e){this.setState({value:e,show:!1})}},{key:"onChange",value:function(e){var t=e.target.value.toString();this.setValue(t),this.props.onChange&&this.props.onChange(t,t,this.props.name)}},{key:"keyUpHandler",value:function(e){this.props.onKeyUp&&this.props.onKeyUp(e)}},{key:"blurHandler",value:function(e){this.props.validate&&this.props.validate(this.state.value),this.props.onBlur&&this.props.onBlur(e.target.value,e.target.value,e)}},{key:"render",value:function(){return n().createElement(n().Fragment,null,n().createElement("div",{className:"wasabi-form-group "+(this.props.className||"")}," ",n().createElement("div",{className:"wasabi-form-group-body"+(this.props.readOnly||this.props.disabled?" readOnly":"")},n().createElement("input",{id:this.props.id,type:this.props.type,name:this.props.name,readOnly:this.props.readOnly,className:"wasabi-input ",onChange:this.onChange,onKeyUp:this.keyUpHandler,onBlur:this.blurHandler,value:this.state.value||"",autoComplete:"off"}),this.props.children)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!==t.oldPropsValue?{value:e.value||"",oldPropsValue:e.value}:null}}]),o}(t.Component);var oe=ee((function e(){X(this,e),this.isParent=null,this.id="",this.pId="",this.text="",this.title="",this.iconCls="",this.iconClose="",this.iconOpen="",this.isOpened=!1,this.checked=!1,this.selectAble=!1,this.draggAble=!1,this.dropAble=!1,this.href=null,this.hide=!1,this.children=null,this.nodeid="",this.textid="",this.children=null,this._path=null,this.half=!1,this.isLast=!1}));const le=function(e){var t=new oe;for(var n in e)"function"!=typeof e[n]&&void 0!==e[n]&&null!==e[n]&&(t[n]=e[n]);return t};function ie(e){var t,r=le(e),a=e.clickId,o=e.loadingId,l=e.selectAble,i=e.checkStyle,c=e.renameAble,d=e.removeAble,s=e.rename,u=e.onDoubleClick,f=e.onClick,p=e.onChecked,h=e.onExpand,y=e.onNodeDragStart,v=e.onNodeDragEnd,b=e.onNodeDrop,g=e.onNodeDragOver,m=e.onNodeDragLeave,k=e.onBlur,D=e.onKeyUp,C=e.beforeNodeRename,A=e.beforeNodeRemove,x=e.textFormatter,w=r.title||r.text,O=r.iconCls;r.isParent&&(O=r.isOpened?r.iconOpen?r.iconOpen:r.iconCls:r.iconClose?r.iconClose:r.iconCls),o===r.id&&(O="icon-loading tree-loading");var I,E,S=!1===r.isOpened?0:(null==r||null===(t=r.children)||void 0===t?void 0:t.length)||0,N=20,T=[];if(r._path.length>1)for(var R=1;R<r._path.length;R++)T.push(n().createElement("span",{key:R,style:{width:20}})),N+=20;if(r.isParent){if(r.isOpened?e.arrowUnFoldIcon&&(I=n().createElement("div",{className:"wasabi-tree-li-icon",style:{display:"inline-block"},onClick:r.isParent?h:null},e.arrowUnFoldIcon)):e.arrowFoldIcon&&(I=n().createElement("div",{className:"wasabi-tree-li-icon",style:{display:"inline-block"},onClick:r.isParent?h:null},e.arrowFoldIcon)),!I){var j="tree"===e.componentType?"icon-caret":"icon-arrow";I=n().createElement("i",{className:(a===r.id?" selected ":"")+(r.open?" wasabi-tree-li-icon  ".concat(j,"-down "):" wasabi-tree-li-icon  ".concat(j,"-right")),onClick:r.isParent?h:null},n().createElement("span",{className:"wasabi-tree-li-icon-beforeRight"}),n().createElement("span",{className:"wasabi-tree-li-icon-afterBelow",style:{height:(S+1)*H.rowDefaultHeight+(r._isLast?-1*H.rowDefaultHeight:15)}}))}}else I=n().createElement("i",{className:(a===r.id?" selected ":"")+" wasabi-tree-li-icon-line"},n().createElement("span",{className:"wasabi-tree-li-icon-afterBelow",style:{height:(S+1)*H.rowDefaultHeight+(r._isLast?-1*H.rowDefaultHeight:15)}}));"checkbox"===i&&(l||r.selectAble)?E=n().createElement(G,{half:r.half,name:"node"+r.id,className:(a===r.id?" selected ":"")+(S>0?" hasChildren ":"  "),value:r.isChecked?r.id:"",data:[{value:r.id,text:""}],onSelect:p}):"radio"===i&&(l||r.selectAble)?E=n().createElement(W,{type:"radio",half:r.half,name:"node"+r.id,className:(a===r.id?" selected ":"")+(S>0?" hasChildren ":"  "),value:r.isChecked?r.id:"",data:[{value:r.id,text:""}],onSelect:p}):"function"==typeof i&&r.selectAble&&(E=i(r)),E&&(N+=20);var B=r.text;return x&&"function"==typeof x&&(B=x(r)),n().createElement("li",{className:"wasabi-tree-li",key:r.pId+"-"+r.id,style:{display:r.hide?"none":"flex"}},T,I,E,n().createElement("div",{id:r.nodeid,style:{width:"calc(100% - ".concat(N,"px)")},className:a===r.id?"wasabi-tree-li-node selected":"wasabi-tree-li-node",title:w,onDrop:b,onDragOver:g,onDragLeave:m,onClick:f,onDoubleClick:u},s?n().createElement(ae,{id:r.textid,required:!0,onKeyUp:D,onBlur:k,name:"key"+r.id,value:r.text}):n().createElement("div",{key:"2",className:"wasabi-tree-li-node-text-div",draggable:r.draggAble,onDragEnd:v,onDragStart:y},n().createElement("i",{key:"3",className:(!r.selectAble&&S?" noCheckhasChildren ":"  ")+O+" wasabi-tree-text-icon"}),n().createElement("a",{href:r.href,className:"wasabi-tree-txt"},B)),!s&&c?n().createElement("i",{key:"edit",className:"icon-edit edit",title:"重命名",onClick:C}):null,!s&&d?n().createElement("i",{key:"delete",className:"icon-delete edit",title:"删除",onClick:A}):null))}function ce(r){var a=i((0,t.useState)(!1),2),o=a[0],l=a[1],c=i((0,t.useState)(g()),1)[0],d=i((0,t.useState)(g()),1)[0];(0,t.useEffect)((function(){if(o){var e=document.getElementById(c);e&&e.focus()}}),[o,c]);var s=(0,t.useCallback)((function(){var e=le(r);r.onClick&&r.onClick(e.id,e.text,e)}),[r]),u=(0,t.useCallback)((function(){var e=le(r);r.onDoubleClick&&r.onDoubleClick(e.id,e.text,e)}),[r]),f=(0,t.useCallback)((function(e){var t=le(r);r.onChecked&&r.onChecked(t.id,t.text,t,e)}),[r]),p=(0,t.useCallback)((function(){var e=le(r),t=!e.isOpened;r.onExpand&&r.onExpand(t,e.id,e.text,e)}),[r]),h=(0,t.useCallback)((function(e,t,n,a){l(!1),r.onRename&&r.onRename(e,t,n,a)}),[r]),y=(0,t.useCallback)((function(){var e=!0;if(r.beforeRename){var t=le(r);e=r.beforeRename(t.id,t.text,t)}l(e)}),[r]),v=(0,t.useCallback)((function(e){var t=le(r);h(t.id,t.text,t,e)}),[r,h]),b=(0,t.useCallback)((function(e){if(13===e.keyCode){var t=le(r);h(t.id,t.text,t,e.target.value.trim())}}),[r,h]),m=(0,t.useCallback)((function(){var e=le(r),t=!0;r.beforeRemove&&(t=r.beforeRemove(e.id,e.text,e)),t&&r.onRemove&&r.onRemove(e.id,e.text,e)}),[r]),k=(0,t.useCallback)((function(e){var t=le(r);if(t.children=null,t.draggAble){var n=!0;r.beforeDrag&&(n=r.beforeDrag((t.id,t.text,t))),n&&(e.dataTransfer.setData("drag",JSON.stringify(t)),window.localStorage.setItem("wasabi-drag-item",JSON.stringify(t)),r.onDrag&&r.onDrag(t.id,t.text,t))}}),[r]),D=(0,t.useCallback)((function(e){e.preventDefault()}),[]),C=(0,t.useCallback)((function(e){e.preventDefault();var t=le(r);if(t.dropAble){var n=document.getElementById(d).getBoundingClientRect().top,a=e.clientY;(!t.dropType||t.dropType&&t.dropType.inddexOf("before")>-1)&&a-n<10?(document.getElementById(d).style.borderTop="1px solid var(--primary-color)",document.getElementById(d).style.borderBottom="none",document.getElementById(d).style.backgroundColor="var(--background-color)",window.localStorage.setItem("wasabi-drag-type","before")):(!t.dropType||t.dropType&&t.dropType.inddexOf("in")>-1)&&a-n<30?(document.getElementById(d).style.borderTop="none",document.getElementById(d).style.borderBottom="none",document.getElementById(d).style.backgroundColor="var(--background-color)",window.localStorage.setItem("wasabi-drag-type","in")):(!t.dropType||t.dropType&&t.dropType.inddexOf("after")>-1)&&(document.getElementById(d).style.borderTop="none",document.getElementById(d).style.borderBottom="1px solid var(--primary-color)",document.getElementById(d).style.backgroundColor="var(--background-color)",window.localStorage.setItem("wasabi-drag-type","after"))}}),[r,d]),A=(0,t.useCallback)((function(e){e.preventDefault(),document.getElementById(d).style.borderTop="none",document.getElementById(d).style.borderBottom="none",document.getElementById(d).style.backgroundColor=null}),[d]),x=(0,t.useCallback)((function(e){e.preventDefault();var t=le(r);document.getElementById(d).style.borderTop="none",document.getElementById(d).style.borderBottom="none",document.getElementById(d).style.backgroundColor=null;var n=JSON.parse(e.dataTransfer.getData("drag"));n||(n=JSON.parse(window.localStorage.getItem("wasabi-drag-item")));var a=window.localStorage.getItem("wasabi-drag-type");if(n&&t.dropAble){var o=!0;r.beforeDrop&&(o=r.beforeDrop(n,t,a)),o&&(window.localStorage.removeItem("wasabi-drag-type"),r.onDrop&&r.onDrop(n,t,a))}}),[r,d]);return n().createElement(ie,e({},r,{rename:o,textid:c,nodeid:d,onClick:s,onDoubleClick:u,onChecked:f,onExpand:p,onBlur:v,onKeyUp:b,beforeNodeRename:y,beforeNodeRemove:m,onNodeDragEnd:D,onNodeDragLeave:A,onNodeDragOver:C,onNodeDragStart:k,onNodeDrop:x}))}ie=n().memo(ie),ce.propTypes={isParent:d().bool,id:d().oneOfType([d().number,d().string]).isRequired,pId:d().oneOfType([d().number,d().string]).isRequired,text:d().oneOfType([d().number,d().string]).isRequired,title:d().string,arrowFoldIcon:d().node,arrowUnFoldIcon:d().node,iconCls:d().string,iconClose:d().string,iconOpen:d().string,isOpened:d().bool,isChecked:d().bool,selectAble:d().bool,draggAble:d().bool,dropAble:d().bool,dropType:d().array,href:d().string,hide:d().bool,children:d().array,onClick:d().func,onDoubleClick:d().func,onCheck:d().func,onExpand:d().func,onRename:d().func,onRemove:d().func,onRightClick:d().func,onDrag:d().func,onDrop:d().func,beforeDrag:d().func,beforeDrop:d().func,beforeRemove:d().func,beforeRename:d().func,beforeRightClick:d().func},ce.defaultProps={iconCls:"icon-text",iconClose:"icon-folder",iconOpen:"icon-folder-open",children:[]};const de=n().memo(ce);function se(t){var r=[],a={componentType:t.componentType,selectAble:t.selectAble,checkStyle:t.checkStyle,renameAble:t.renameAble,removeAble:t.removeAble,draggAble:t.draggAble,dropAble:t.dropAble,dropType:t.dropType,clickId:t.clickId,loadingId:t.loadingId},o={beforeDrag:t.beforeDrag,beforeRemove:t.beforeRemove,beforeDrop:t.beforeDrop,beforeRename:t.beforeRename,onClick:t.onClick,onDoubleClick:t.onDoubleClick,onChecked:t.onChecked,onRemove:t.onRemove,onExpand:t.onExpand,onRename:t.onRename,onDrop:t.onDrop,onDrag:t.onDrag,textFormatter:t.textFormatter},l=t.visibleData;return Array.isArray(l)&&(r=l.map((function(t,r){var l=!1;return(!0===t.isParent||Array.isArray(t.children)&&t.children.length>0)&&(l=!0),n().createElement(de,e({key:"treenode-"+t.pId+"-"+t.id},a,t,{isParent:l},o))}))),n().createElement("ul",{id:t.treeid,className:"wasabi-tree clearfix "+(!1===t.dottedAble?" nodotted ":"")},r)}const ue=n().memo(se);var fe=function(e){var t=document.getElementById(e).clientHeight,n=Math.ceil(t/H.rowDefaultHeight),r=document.getElementById(e).scrollTop||0,a=Math.floor(r/H.rowDefaultHeight)||0;return{visibleDataCount:n,startIndex:a,endIndex:a+H.bufferScale*n}},pe=function(e,t,n,r){var a={type:t||"post",contentType:n,url:e,headers:r||{},data:arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},success:arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,error:arguments.length>6&&void 0!==arguments[6]?arguments[6]:null};u().ajax(a),console.log("tree async-fetch",a)},he=n().forwardRef((function(r,a){var o=r.componentType,l=void 0===o?"tree":o,c=r.style,d=r.className,s=r.url,u=r.httpType,f=r.contentType,p=r.headers,h=r.params,y=r.data,v=void 0===y?null:y,m=r.dataSource,A=void 0===m?"data":m,x=r.idField,w=void 0===x?"id":x,I=r.parentField,E=void 0===I?"pId":I,S=r.textField,N=void 0===S?"text":S,T=r.childrenField,R=void 0===T?"children":T,j=r.dottedAble,B=void 0===j||j,P=r.selectAble,_=r.draggAble,V=r.dropAble,M=r.renameAble,U=r.removeAble,q=r.asyncAble,J=r.foldBroAble,Y=r.dropType,$=r.isSimpleData,z=r.checkStyle,G=r.checkType,Q=r.radioType,W=r.loadSuccess,X=r.onClick,Z=r.onDoubleClick,ee=r.onChecked,te=r.onRemove,ne=r.onRename,re=r.onDrop,ae=r.onDrag,oe=r.onExpand,le=r.onAsync,ie=r.beforeDrag,ce=r.beforeRemove,de=r.beforeDrop,se=r.beforeRename,he=i((0,t.useState)(g()),1)[0],ye=i((0,t.useState)(g()),1)[0],ve=i((0,t.useReducer)(K,{}),2),be=ve[0],ge=ve[1],me=i((0,t.useState)({idField:w,parentField:E,textField:N,childrenField:R,isSimpleData:$}),1)[0],ke=(0,t.useRef)({visibleDataArgs:{startIndex:0,endIndex:0,sliceBeginIndex:0,sliceEndIndex:0,visibleDataCount:0},data:null,flatData:null,filterData:null,hashData:new Map}),De=(0,t.useCallback)((function(e,t,n){ge({type:"onClick",payload:e}),setTimeout((function(){X&&X(e,t,n)}),100)}),[X]),Ce=(0,t.useCallback)((function(e,t,n){ge({type:"onDoubleClick",payload:e}),Z&&Z(e,t,n)}),[Z]),Ae=(0,t.useCallback)((function(e,t,n,r){L(ke,{type:"onChecked",payload:{id:e,text:t,node:n,checkValue:r,checkType:G,checkStyle:z,radioType:Q}},ge);var a=(null!=e?e:"").toString()===(null!=r?r:"").toString();setTimeout((function(){ee&&ee(a,e,t,n)}),100)}),[ee,G,z,Q]),xe=(0,t.useCallback)((function(e,t,n){window.confirm("您确定删除["+t+"］吗")&&(L(ke,{type:"onRemove",payload:{id:e,options:me}},ge),te&&te(e,t,n))}),[te]),we=(0,t.useCallback)((function(e,t,n,r){L(ke,{type:"onRename",payload:{id:e,newText:r,options:me}},ge),ne&&ne(e,t,n,r)}),[ne]),Oe=(0,t.useCallback)((function(e,t,n){L(ke,{type:"onDrop",payload:{dragNode:e,dropNode:t,dragType:n,options:me}},ge),re&&re(e,t,n)}),[re]),Ie=(0,t.useCallback)((function(e,t,n,r){if(L(ke,{type:"setOpen",payload:{id:t,isOpened:e,foldBroAble:J}},ge),q&&(!r.children||0===r.children.length)){var a=[];if(le&&"function"==typeof le)a=le(t,n,r),Array.isArray(a)&&L(ke,{type:"append",payload:{asyncChildrenData:a,id:t,options:me}},ge);else if(s){ge({type:"loading",payload:{loadingId:t}}),window.sessionStorage.setItem("async-tree-node",JSON.stringify(r));var o=b(h)||{};o[w||"id"]=t,pe(s,u,f,p,o,(function(e){a=le(t,n,r),Array.isArray(a)&&L(ke,{type:"append",payload:{asyncChildrenData:a,id:t,options:me}},ge)}))}}oe&&oe(e,t,n,r)}),[w,E,N,R,$,oe]),Ee=(0,t.useCallback)((function(){var e=fe(he);Se(e.startIndex,e.endIndex,e.visibleDataCount)}),[he]),Se=(0,t.useCallback)((function(e,t,n){var r;if(e>=1){var a=e*H.rowDefaultHeight-(e-H.bufferScale*n>=0?(e-H.bufferScale*n)*H.rowDefaultHeight:0);r=e*H.rowDefaultHeight-a}else r=0;document.getElementById(ye).style.transform="translate3d(0,".concat(r,"px,0)");var o=e-H.bufferScale*n;o=o<0?0:o;var l=t+H.bufferScale*n;ke.current.visibleDataArgs={sliceBeginIndex:o,sliceEndIndex:l},ge({type:"showVisibleData",payload:{sliceBeginIndex:o,sliceEndIndex:l,gobalData:ke}})}),[he]);(0,t.useImperativeHandle)(a,(function(){return{findNode:function(e){return D(ke.current.hashData,ke.current.data,e)},findParents:function(e){var t=D(ke.current.hashData,ke.current.data,e);return t&&t._path?C(ke.current.data,t._path):[]},getData:function(){return ke.current.data},getChecked:function(){return O(ke.current.data)},setChecked:function(e,t){L(ke,{type:"setChecked",payload:{id:e,isChecked:t,checkType:G,checkStyle:z,radioType:Q}},ge)},clearChecked:function(){L(ke,{type:"clearChecked"},ge)},checkedAll:function(){L(ke,{type:"checkedAll"},ge)},selectNode:function(e){L(ke,{type:"setLinkOpen",payload:e},ge),ge({type:"selectNode",payload:{gobalData:ke,id:e}})},setLinkOpen:function(e){L(ke,{type:"setLinkOpen",payload:e},ge)},remove:function(e){L(ke,{type:"remove",payload:{ids:e,options:me}},ge)},removeAll:function(){L(ke,{type:"removeAll"},ge)},filter:function(e){document.getElementById(he).scrollTop=0,L(ke,{type:"filter",payload:e}),Ee()},append:function(e,t){Array.isArray(e)&&(t||(document.getElementById(he).scrollTop=0),L(ke,{type:"append",payload:{children:e,pId:t,options:me}},ge),Ee())},update:function(e){e&&L(ke,{type:"update",payload:{nodes:e,options:me}},ge)},updateAll:function(e){document.getElementById(he).scrollTop=0,L(ke,{type:"updateAll",payload:{options:me,data:e,containerid:he}},ge),Ee()},moveIn:function(e,t){L(ke,{type:"moveIn",payload:{dragId:e,dropId:t,options:me}},ge)},moveBefore:function(e,t){L(ke,{type:"moveBefore",payload:{dragId:e,dropId:t,options:me}},ge)},moveAfter:function(e,t){L(ke,{type:"moveAfter",payload:{dragId:e,dropId:t,options:me}},ge)},adjust:function(){Ee()}}})),(0,t.useEffect)((function(){s?pe(s,u,f,p,h,(function(e){ke.current.data=F(ke.current.hashData,"",[],function(e,t,n){var r=null;try{var a=window.sessionStorage.getItem("async-tree-node");if(a=a?JSON.parse(a):{},"function"==typeof n){var o=n(e);r=o&&o instanceof Array?o:e}else r=getSource(e,t);return r}catch(e){console.error("handerLoadData",e)}return[]}(e,A,W),me),ke.current.flatData=k(ke.current.data),Ee()})):(ke.current.data=F(ke.current.hashData,"",[],v,me),ke.current.flatData=k(ke.current.data),Ee())}),[v,s]),(0,t.useEffect)((function(){if(be.scrollIndex&&be.scrollIndex.index>=0){var e=fe(he);(be.scrollIndex.index>e.endIndex||be.scrollIndex.index<e.startIndex)&&(document.getElementById(he).scrollTop=(be.scrollIndex.index-1)*H.rowDefaultHeight)}}),[be.scrollIndex]);var Ne,Te={componentType:l,dottedAble:B,selectAble:P,checkStyle:z,renameAble:M,removeAble:U,draggAble:_,dropAble:V,dropType:Y,asyncAble:q,clickId:be.clickId,loadingId:be.loadingId},Re={beforeDrag:ie,beforeRemove:ce,beforeDrop:de,beforeRename:se,onDrag:ae,onClick:De,onDoubleClick:Ce,onChecked:Ae,onRemove:xe,onExpand:Ie,onRename:we,onDrop:Oe};return l&&"tree"!==l||(Ne=n().createElement(ue,e({},Te,be,Re,{treeid:ye}))),n().createElement("div",{id:he,onScroll:Ee,className:"wasabi-tree-parent "+(null!=d?d:""),style:c},Ne,n().createElement("div",{style:{left:0,top:0,height:ke.current.flatData&&ke.current.flatData.length*H.rowDefaultHeight,position:"absolute",width:1}}))}));he.propTypes={componentType:d().oneOf(["tree","treegrid"]),name:d().string,style:d().object,className:d().string,idField:d().string,parentField:d().string,textField:d().string,childrenField:d().string,dottedAble:d().bool,url:d().string,params:d().object,dataSource:d().string,headers:d().array,data:d().array,isSimpleData:d().bool,selectAble:d().bool,checkStyle:d().oneOf(["checkbox","radio",d().func]),checkType:d().object,radioType:d().oneOf(["level","all"]),renameAble:d().bool,removeAble:d().bool,draggAble:d().bool,dropAble:d().bool,dropType:d().array,asyncAble:d().bool,foldBroAble:d().bool,onClick:d().func,onDoubleClick:d().func,onCheck:d().func,onExpand:d().func,onRename:d().func,onRemove:d().func,onRightClick:d().func,onDrag:d().func,onDrop:d().func,onAsync:d().func,loadSuccess:d().func,beforeDrag:d().func,beforeDrop:d().func,beforeRemove:d().func,beforeRename:d().func,beforeRightClick:d().func},he.defaultProps={componentType:"tree",idField:"id",parentField:"pId",textField:"text",childrenField:"children",dataSource:"data",dottedAble:!0,checkStyle:"checkbox",checkType:{y:"ps",n:"ps"},radioType:"all"};const ye=n().memo(he);function ve(t,r){return n().createElement(ye,e({},t,{ref:r,componentType:"tree"}))}const be=n().memo(n().forwardRef(ve))})(),l})()));