!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("prop-types"),require("react"),require("wasabi-api")):"function"==typeof define&&define.amd?define(["prop-types","react","wasabi-api"],t):"object"==typeof exports?exports["wasabi-tree"]=t(require("prop-types"),require("react"),require("wasabi-api")):e["wasabi-tree"]=t(e["prop-types"],e.react,e["wasabi-api"])}(self,(function(e,t,n){return(()=>{"use strict";var r={99:t=>{t.exports=e},156:e=>{e.exports=t},313:e=>{e.exports=n}},o={};function a(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e](n,n.exports,a),n.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{a.r(i),a.d(i,{default:()=>J});var e=a(156),t=a.n(e);function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},c(e,t)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function u(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var f=a(99),v=a.n(f);function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D={titleize:function(e){return e.toLowerCase().replace(/(?:^|\s)\w/g,(function(e){return e.toUpperCase()}))},camelize:function(e){return e.replace(/[-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))},dasherize:function(e){return e.replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},GetArgsFromHref:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=(t=t||window.location.href).toString().split("?"),r="";if(n[0]==t)return r;var o=n[1];o.indexOf("#")>-1&&(o=(o=o.split("#"))[0].indexOf("=")>-1?o[0]:o[1]),n=o.toString().split("&");for(var a=0;a<n.length;a++){var i=(o=n[a]).toString().split("=");i.length<=1||i[0]==e&&(r=i[1])}return r},BrowserType:function(){var e="",t=navigator.userAgent.toLowerCase();return t.indexOf("opera")>-1||t.indexOf("opr")>-1?e="Opera":t.indexOf("firefox")>-1?e="Firefox":t.indexOf("chrome")>-1?e="Chrome":t.indexOf("safari")>-1?e="Safari":/msie|trident/.test(t)&&(e=D.IEType()),e},IEType:function(){return navigator.userAgent.indexOf("MSIE 6.")>-1?"IE 6":navigator.userAgent.indexOf("MSIE 7.")>-1?"IE 7":navigator.userAgent.indexOf("MSIE 8.")>-1?"IE 8":navigator.userAgent.indexOf("MSIE 9.")>-1?"IE 9":navigator.userAgent.indexOf("MSIE 10.")>-1?"IE 10":navigator.userAgent.toLowerCase().indexOf("trident")>-1?"IE 11":void 0},dealNumToEnglishFormat:function(e){return isNaN(e)?e:e.toString().split("").reverse().join("").replace(/(.{3})/g,"$1,").split("").reverse().join("").replace(/^,/,"")},dateformat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd HH:mm:ss";if(e){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours()%12==0?12:e.getHours()%12,"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()},r={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};for(var o in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(t)&&(t=t.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+r[e.getDay()+""])),n)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[o]:("00"+n[o]).substr((""+n[o]).length)));return t}},stringToDate:function(e){return new Date(Date.parse(e.replace(/-/g,"/")))}};D.cookies={set:function(e,t){var n=new Date;n.setTime(n.getTime()+6048e5),document.cookie=e+"="+t+";path=/;expires="+n.toGMTString()},get:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?t[2]:null},del:function(e){var t=new Date;t.setTime(t.getTime()-1);var n=this.get(e);null!=n&&(document.cookie=e+"="+n+";expires="+t.toGMTString())}},D.clone=function(e){var t;if("object"===h(e))if(null===e)t=null;else if(e instanceof Array){t=[];for(var n=0;n<e.length;n++)t.push(D.clone(e[n]))}else if(e instanceof Date)t=new Date(e.valueOf());else if(e instanceof Map)t=new Map(e);else if(e instanceof Set)t=new Set(e);else for(var r in t={},e)t[r]=D.clone(e[r]);else t=e;return t},D.shallowClone=function(e){return"object"===h(e)?null===e?null:e instanceof Array?e.slice(0):e instanceof Date?new Date(e.valueOf()):e instanceof Map?new Map(e):e instanceof Set?new Set(e):k({},e):e},D.getSource=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",n=new Array,r=e;t.indexOf(".")>-1?n=t.split("."):n.push(t);var o=0;try{for(;o<n.length;){if(null==(r=r[n[o]]))return null;o++}}catch(e){return null}return r},D.isEmptyObject=function(e){var t=!0;if("object"===h(e))for(var n in e)t=!1;return t},D.download=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".xlsx";"object"==h(e)&&e instanceof Blob?e=URL.createObjectURL(e):n=e.substr(e.lastIndexOf(".")),t=t||D.dateformat(new Date,"yyyy-MM-dd HH:mm:ss");var r=document.createElement("a");r.href=e,r.download=t+n,r.click(),window.URL.revokeObjectURL(r.href)},D.uuid=function(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")},D.diff=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e===t)return!1;if(Object.prototype.toString.call(e)!==Object.prototype.toString.call(t))return!0;if("function"==typeof e)return e.toString()===t.toString();if("object"!==h(e))return e!==t;try{if(Object.prototype.toString.call(e).indexOf("Map")>-1||Object.prototype.toString.call(e).indexOf("Set")>-1)return e!==t;var r=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(r.length!==o.length)return!0;for(var a=0;a<r.length;a++){var i=r[a],l=e[i],s=t[i];if(n){if(D.diff(l,s,n))return!0}else if(l!==s)return!0}}catch(n){console.log(e,t)}return!1},D.componentMixins=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{t.forEach((function(t){Object.getOwnPropertyNames(t).forEach((function(n){"function"==typeof t[n]&&(e.prototype[n]=t[n])}))}))}catch(e){}return e},D.toTreeData=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"pId",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text";e=D.clone(e);for(var o=[],a={},i=0,l="",s="",c=0;c<e.length;c++)s+=","+e[c][t]+",";for(var d=0;d<e.length;d++)s.indexOf(","+e[d][n]+",")<=-1&&(l+=","+e[d][n]+",");for(var h=0;0!==e.length&&i<2e6;){if(i++,l.indexOf(","+e[h][n]+",")>-1||!e[h][n]){var u=k(k({},e[h]),{},{id:e[h][t],pId:e[h][n],text:e[h][r],children:[]});o.push(u),a[e[h][t]]=[o.length-1],u._path=[o.length-1],u.children=D.formatTreeDataChildren(e[h].children,u.id,u._path,t,n,r),e.splice(h,1),h--}else{var p=a[e[h][n]];if(p){for(var f=o[p[0]],v=1;v<p.length;v++)f=f.children[p[v]];var g=k(k({},e[h]),{},{id:e[h][t],pId:e[h][n],text:e[h][r],children:e[h].children||[]});f.children.push(g),a[e[h][t]]=p.concat([f.children.length-1]),g._path=a[e[h][t]],g.children=D.formatTreeDataChildren(e[h].children,g.id,g._path,t,n,r),e.splice(h,1),h--}}++h>e.length-1&&(h=0)}return e.length>0&&console.error("数据格式不正确，或者是数据量过大，请使用异步请求"),o},D.formatTreeDataChildren=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"id",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"pId",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"text";if(e&&e instanceof Array&&e.length>0){for(var i=0;i<e.length;i++){var l=[].concat(y(n),[i]);e[i]=k(k({},e[i]),{},{id:e[i][r],pId:t,text:e[i][a],_path:l,children:D.formatTreeDataChildren(e[i].children,e[i][r],l,r,o,a)})}return e}return[]},D.treeDataToFlatData=function(e){var t=[];if(e&&e instanceof Array)for(var n=0;n<e.length;n++)t.push(k(k({},e[n]),{},{isLast:n===e.length-1})),e[n].children&&e[n].children.length>0&&!1!==e[n].open&&(t=t.concat(D.treeDataToFlatData(e[n].children)));return t},D.deepMerge=function(e,t){for(var n in t)"[object Object]"===e[n].toString()?D.deepMerge(e[n],t[n]):e[n]=t[n];return e},D.arrayNodupMerge=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",r=[].concat(e,t),o=[],a={},i=0;i<r.length;i++)a[r[i][n]]||(o.push(r[i]),a[r[i][n]]=!0);return o},D.charWidth=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=0;try{for(var n=e.split(""),r=0;r<n.length;r++){var o=new RegExp("[\\u4E00-\\u9FFF]+","g");o.test(n[r])?t+=20:t+=10}}catch(e){}return t},D.throttle=function(e,t){var n=Date.now();return function(){var r=this,o=arguments,a=Date.now();a-n>=t&&(e.apply(r,o),n=Date.now())}},D.getDateDiffDay=function(e,t){try{return(1*e-1*t)/60/60/1e3/24}catch(e){return NaN}},D.getFirstDateInMonth=function(e){return new Date(e.getFullYear(),e.getMonth(),1)},D.getLastDateInMonth=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0)},D.getFirstDateInQuarter=function(e){return new Date(e.getFullYear(),3*~~(e.getMonth()/3),1)},D.getLastDateInQuarter=function(e){return new Date(e.getFullYear(),3*~~(e.getMonth()/3)+3,0)},D.isLeapYear=function(e){return 29===new Date(e.getFullYear(),2,0).getDate()},D.getDaysInMonth=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()},D.getFirstDayWeek=function(e){return new Date(e.getFullYear(),e.getMonth(),1).getDay()},D.getNextYear=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=D.clone(e);return n.setYear(n.getFullYear()+t),n},D.getNextMonth=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=D.clone(e);return n.setMonth(n.getMonth()+t),n},D.getNextDay=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=D.clone(e);return n.setDate(n.getDate()+t),n},D.getNextHour=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=D.clone(e);return n.setHours(n.getHours()+t),n};const x=D;function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={findNodeById:function(e,t){var n;if(e&&e.length>0&&null!=t&&""!==t)for(var r=0;r<e.length;r++){if(e[r].id===t)return e[r];if(e[r].children&&e[r].children instanceof Array&&e[r].children.length>0&&(n=S.findNodeById(e[r].children,t)))return n}return n},findNodeByPath:function(e,t){var n;if(e&&e.length>0&&t&&t.length>0&&(n=e[t[0]],t&&t.length>1))for(var r=1;r<t.length;r++)n.children&&n.children.length>0&&(n=n.children[t[r]]);return n},findLinkNodesByPath:function(e,t){var n=[];if(e&&e.length>0&&t&&t.length>0&&(n=[e[t[0]]],t&&t.length>1))for(var r=1;r<t.length;r++)n[n.length-1].children&&n[n.length-1].children.length>0&&n.push(n[n.length-1].children[t[r]]);return n},setSelfChecked:function(e,t){if(e)for(var n=0;n<t.length;n++)(","+e+",").indexOf(","+t[n].id+",")>-1?t[n].checked=!0:t[n].checked=!1,t[n].children&&t[n].children.length>0&&(t[n].children=S.setSelfChecked(e,t[n].children));return t},setChecked:function(e,t,n,r){try{var o=this.findLinkNodesByPath(e,t._path);if(o&&o.length>0){var a=o[o.length-1];(n&&r&&r.y&&r.y.indexOf("s")>-1||!n&&r&&r.n&&r.n.indexOf("s")>-1)&&(a=this.setNodeChildrenChecked(a,n)),(n&&r&&r.y&&r.y.indexOf("p")>-1||!n&&r&&r.n&&r.n.indexOf("p")>-1)&&this.setNodeParentsChecked(o)}}catch(e){}return e},setRadioChecked:function(e,t,n,r){try{if("all"==r){e=S.clearChecked(e);var o=this.findLinkNodesByPath(e,t._path);o&&o.length>0&&(o[o.length-1].checked=n,o[o.length-1].half=!1)}else if("level"==r){var a=this.findLinkNodesByPath(e,t._path);if(a&&a.length>=2){var i=a[a.length-2];if(i.children&&i.children.length>0)for(var l=0;l<i.children.length;l++)i.children[l].checked=!1,i.children[l].half=!1}else if(a&&1==a.length)for(var s=0;s<e.length;s++)e[s].checked=!1,e[s].half=!1;a&&a.length>0&&(a[a.length-1].checked=n,a[a.length-1].half=!1)}}catch(e){console.log(e)}return e},setNodeChildrenChecked:function(e,t){if(e.checked=t,e.half=!1,e.children&&e.children.length>0)for(var n=0;n<e.children.length;n++)e.children[n]=this.setNodeChildrenChecked(e.children[n],t);return e},setNodeParentsChecked:function(e){if(e&&e.length>1)for(var t=e.length-2;t>=0;t--)if(e[t].children&&e[t].children.length>0){for(var n=0,r=0,o=0;o<e[t].children.length;o++)e[t].children[o].checked&&n++,e[t].children[o].half&&r++;n===e[t].children.length?(e[t].checked=!0,e[t].half=!1):n>0&&n!==e[t].children.length||r>0?(e[t].checked=!1,e[t].half=!0):(e[t].checked=!1,e[t].half=!1)}},getChecked:function(e){var t=[];if(e&&e instanceof Array&&e.length>0)for(var n=0;n<e.length;n++)e[n].checked&&t.push(e[n]),e[n].children&&e[n].children.length>0&&(t=[].concat(t,this.getChecked(e[n].children)));return t},clearChecked:function(e){if(e&&e instanceof Array&&e.length>0){for(var t=0;t<e.length;t++)e[t].checked=!1,e[t].half=!1,e[t].children&&e[t].children.length>0&&(e[t].children=S.clearChecked(e[t].children));return e}},checkedAll:function(e){if(e&&e instanceof Array&&e.length>0){for(var t=0;t<e.length;t++)e[t].checked=!0,e[t].half=!1,e[t].children&&e[t].children.length>0&&(e[t].children=S.checkedAll(e[t].children));return e}},setOpen:function(e,t){var n=this.findLinkNodesByPath(e,t._path);if(n&&n.length>0){var r=n[n.length-1];r.open=null!=r.open&&null!=r.open&&!r.open}return e},renameNode:function(e,t,n){if(e&&e.length>0){var r=S.findLinkNodesByPath(e,t._path);r&&(r[r.length-1].text=n)}return e},removeNode:function(e,t){var n=S.findLinkNodesByPath(e,t._path);if(1==n.length)e.splice(n[0]._path[0],1),e=S.setChildrenPath("",[],e);else{var r=n[n.length-2];r.children.splice(t._path[t._path.length-1],1),r.children=S.setChildrenPath(r.id,r._path,r.children)}return e},moveInNode:function(e,t,n){var r=S.findLinkNodesByPath(e,t._path),o=S.findLinkNodesByPath(e,n._path);if(o){var a=r[r.length-1],i=o[o.length-1];i.children||(i.children=[]),i.children.push(C(C({},a),{},{pId:i.id,_path:[].concat(y(i._path),[i.children.length]),children:S.setChildrenPath(a.id,[].concat(y(a._path),[a.children.length]),a.children)})),e=S.removeNode(e,a)}return e},moveBeforeNode:function(e,t,n){return S.moveBeforeOrAfterNode(e,t,n,0)},moveAterNode:function(e,t,n){return S.moveBeforeOrAfterNode(e,t,n,1)},moveBeforeOrAfterNode:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;try{var o=S.findLinkNodesByPath(e,t._path),a=S.findLinkNodesByPath(e,n._path);if(o&&a){var i=o[o.length-1],l=a[a.length-1];if(1==a.length)e=[].concat(y(e.slice(0,l._path[0]+r)),[C(C({},i),{},{pId:"",_path:l._path})],y(e.slice(l._path[0]+r,e.length))),e=this.setChildrenPath("",[],e);else{var s=a[a.length-2];s.children=[].concat(y(s.children.slice(0,l._path[0]+r)),[C(C({},i),{},{pId:l.pId,_path:l._path})],y(s.children.slice(l._path[0]+r,s.children.length))),s.children=this.setChildrenPath(s.id,s._path,s.children)}e=S.removeNode(e,i)}}catch(e){}return e},setChildrenPath:function(e,t,n){if(n&&n.length>0){for(var r=0;r<n.length;r++){try{n[r]._path=[].concat(y(t),[r])}catch(e){console.log(r,n,n[r])}n[r].pId=e,n[r].children&&n[r].children.length>0&&(n[r].children=S.setChildrenPath(n[r].id,[].concat(y(t),[r]),n[r].children))}return n}return[]},filter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=[];if(t=t.trim())for(var r=0;r<e.length;r++){var o=null;if(((e[r].id+"").indexOf(t)>-1||(e[r].text+"").indexOf(t)>-1)&&((o=e[r]).open=!0),e[r].children&&e[r].children.length>0){var a=S.filter(e[r].children,t);a&&a.length>0&&((o=e[r]).open=!0,o.children=a)}o&&n.push(o)}return n},appendChildren:function(e,t,n){if(n){n._path||(n=S.findNodeById(e,n.id));var r=S.findLinkNodesByPath(e,n._path);if(r&&r.length>0){var o,a=r[r.length-1],i=null!==(o=a.children)&&void 0!==o?o:[];a.children=[].concat(i,t),a.children=S.setChildrenPath(a.id,a._path,a.children)}return e}e=e.concat(t),e=S.setChildrenPath("",[],e)},setVisibleDataProps:function(e,t){if(e.length>0){var n=[];return e.forEach((function(e){var r=S.findNodeByPath(t,e._path);n.push(C(C({},e),{},{checked:r.checked,open:r.open}))})),n}return[]}};const O=S;var N=a(313),E=a.n(N);const R=30,I=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];if(n&&n instanceof Array&&n.length>0)for(var o=0;o<n.length;o++)if((","+t+",").indexOf(","+(n[o].value+""||n[o].id+"")+",")>-1&&r.push(n[o].text),n[o].children&&n[o].children.length>0){var a=e(t,n[o].children);r=[].concat(a,r)}return r||[]};function P(e){var n=this,r=e.data,o=e.value,a=e.half,i=e.readOnly,l=e.onSelect,s=null;return r&&r instanceof Array&&r.length>0&&(s=r.map((function(e,r){var s=function(e){var t=!1;return o&&(","+o.toString()+",").indexOf(","+e.value+",")>-1&&(t=!0),t}(e);return t().createElement("li",{key:r,onClick:l.bind(n,e.value,e.text,e)},t().createElement("label",{className:"checkbox-label "+(s?" checked ":" ")+(a?" halfcheck ":""),readOnly:i}),t().createElement("div",{className:"checktext "+(s?" checked":""),readOnly:i},e.text))}))),s}var B=function(e){d(i,e);var n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(n);if(o){var r=p(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function i(e){var t;return r(this,i),(t=a.call(this,e)).state={text:"",value:"",oldPropsValue:null},t.setValue=t.setValue.bind(s(t)),t.getValue=t.getValue.bind(s(t)),t.onSelect=t.onSelect.bind(s(t)),t}return l(i,[{key:"setValue",value:function(e){this.setState({value:e,text:I(e,this.props.data).join(",")}),this.props.validate&&this.props.validate(e)}},{key:"getValue",value:function(){return this.state.value}},{key:"onSelect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(!this.props.readOnly)if(null!=e&&null!=e&&""!=e){var r=this.state.value.toString()||"",o=this.state.text.toString()||"";if(r=r?r.split(","):[],o=o?o.split(","):[],r.indexOf(e.toString())>-1){r.splice(r.indexOf(e.toString()),1);try{o.splice(o.indexOf(t.toString()),1)}catch(e){}}else r.push(e+""),o.push(t+"");this.setState({value:r.join(","),text:o.join(",")}),this.props.validate&&this.props.validate(r.join(",")),this.props.onSelect&&this.props.onSelect(r.join(","),o.join(","),this.props.name,n)}else alert("值是空值")}},{key:"render",value:function(){var e=this.props,n={data:e.data,half:e.half,readOnly:e.readOnly,onSelect:this.onSelect,value:this.state.value};return t().createElement("div",{className:"wasabi-form-group "+(this.props.className||"")}," ",t().createElement("div",{className:"wasabi-form-group-body"+(this.props.readOnly||this.props.disabled?" readOnly":"")},t().createElement("ul",{className:"wasabi-checkul"},t().createElement(P,n)," ",this.props.children," ")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!=t.oldPropsValue?{value:e.value||"",text:I(e.value,e.data).join(","),oldPropsValue:e.value}:null}}]),i}(t().Component);const A=B;function j(e){var n=this,r=null,o=e.data,a=e.value,i=e.readOnly,l=e.onSelect;if(o&&o instanceof Array&&o.length>0){var s="wasabi-radio-btn "+(i?" readOnly":"");r=o.map((function(e,r){return t().createElement("li",{key:r},t().createElement("div",{className:s+(a&&a+""==e.value+""?" checkedRadio":""),onClick:l.bind(n,e.value,e.text,e)},t().createElement("i",null)),t().createElement("div",{className:"radiotext "+(i?" readOnly":"")+(a&&a+""==e.value+""?" checkedRadio":""),onClick:l.bind(n,e.value,e.text,e)},e.text))}))}return r}var T=function(e){d(c,e);var o,a,i=(o=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(o);if(a){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function c(e){var t;return r(this,c),(t=i.call(this,e)).state={text:"",value:"",oldPropsValue:""},t.setValue=t.setValue.bind(s(t)),t.getValue=t.getValue.bind(s(t)),t.onSelect=t.onSelect.bind(s(t)),t}return l(c,[{key:"setValue",value:function(e){this.setState({value:e,text:I(e,this.props.data).join(",")}),this.props.validate&&this.props.validate(e)}},{key:"getValue",value:function(){return this.state.value}},{key:"onSelect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.props.readOnly||(null!=e&&null!=e&&""!=e?(this.setState({value:e+"",text:t+""}),this.props.validate&&this.props.validate(e+""),this.props.onSelect&&this.props.onSelect(e+"",t,n,r)):alert("值是空值"))}},{key:"render",value:function(){var e=this.props,r={data:e.data,readOnly:e.readOnly,value:this.state.value,onSelect:this.onSelect};return t().createElement("div",{className:"wasabi-form-group "+(this.props.className||"")}," ",t().createElement("div",{className:"wasabi-form-group-body"+(this.props.readOnly||this.props.disabled?" readOnly":"")},t().createElement("ul",{className:"wasabi-checkul radio"}," ",t().createElement(j,n({},r,{onSelect:this.onSelect.bind(this)}))," ",this.props.children)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!=t.oldPropsValue?{value:e.value||"",text:I(e.value,e.data).join(","),oldPropsValue:e.value}:null}}]),c}(e.Component);const F=T;const _=function(e){d(i,e);var n,o,a=(n=i,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(n);if(o){var r=p(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function i(e){var t;return r(this,i),(t=a.call(this,e)).state={oldPropsValue:null,value:t.props.value||""},t.onChange=t.onChange.bind(s(t)),t.keyUpHandler=t.keyUpHandler.bind(s(t)),t.blurHandler=t.blurHandler.bind(s(t)),t.getValue=t.getValue.bind(s(t)),t.setValue=t.setValue.bind(s(t)),t}return l(i,[{key:"getValue",value:function(){return this.state.value}},{key:"setValue",value:function(e){this.setState({value:e,show:!1})}},{key:"onChange",value:function(e){var t=e.target.value.toString();this.setValue(t),this.props.onChange&&this.props.onChange(t,t,this.props.name)}},{key:"keyUpHandler",value:function(e){this.props.onKeyUp&&this.props.onKeyUp(e)}},{key:"blurHandler",value:function(e){this.props.validate&&this.props.validate(this.state.value),this.props.onBlur&&this.props.onBlur(e.target.value,e.target.value,e)}},{key:"render",value:function(){return t().createElement(t().Fragment,null,t().createElement("div",{className:"wasabi-form-group "+(this.props.className||"")}," ",t().createElement("div",{className:"wasabi-form-group-body"+(this.props.readOnly||this.props.disabled?" readOnly":"")},t().createElement("input",{id:this.props.id,type:this.props.type,name:this.props.name,readOnly:this.props.readOnly,className:"wasabi-input ",onChange:this.onChange,onKeyUp:this.keyUpHandler,onBlur:this.blurHandler,value:this.state.value||"",autoComplete:"off"}),this.props.children)))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.value!=t.oldPropsValue?{value:e.value||"",oldPropsValue:e.value}:null}}]),i}(e.Component),V=l((function e(){r(this,e),this.isParent=null,this.id="",this.pId="",this.text="",this.title="",this.iconCls="",this.iconClose="",this.iconOpen="",this.open=!0,this.checked=!1,this.selectAble=!1,this.draggAble=!1,this.dropAble=!1,this.href=null,this.hide=!1,this.children=null,this.nodeid="",this.textid="",this.children=null,this._path=null,this.half=!1,this.isLast=!1}));function L(e){var n,r=new V;for(var o in r)r[o]=null!=e[o]&&null!=e[o]?e[o]:r[o];var a=e.clickId,i=e.loadingId,l=e.selectAble,s=e.checkStyle,c=e.renameAble,d=e.removeAble,h=e.rename,u=e.onDoubleClick,p=e.onClick,f=e.onChecked,v=e.onExpand,g=e.onNodeDragStart,y=e.onNodeDragEnd,m=e.onNodeDrop,b=e.onNodeDragOver,k=e.onNodeDragLeave,D=e.onBlur,x=e.onKeyUp,w=r.title||r.text,C=r.iconCls;r.isParent&&(C=r.open?r.iconOpen?r.iconOpen:r.iconCls:r.iconClose?r.iconClose:r.iconCls),i===r.id&&(C="icon-loading tree-loading");var S,O,N=!1===r.open?0:(null==r||null===(n=r.children)||void 0===n?void 0:n.length)||0,E=20,I=[];if(r._path.length>1)for(var P=1;P<r._path.length;P++)I.push(t().createElement("span",{key:P,style:{width:20}})),E+=20;if(r.open?e.arrowUnFoldIcon&&(S=t().createElement("div",{className:"wasabi-tree-li-icon",style:{display:"inline-block"},onClick:r.isParent?v.bind(this,!r.open,r.id,r.text,r):null},e.arrowUnFoldIcon)):e.arrowFoldIcon&&(S=t().createElement("div",{className:"wasabi-tree-li-icon",style:{display:"inline-block"},onClick:r.isParent?v.bind(this,!r.open,r.id,r.text,r):null},e.arrowFoldIcon)),!S){var B="tree"===e.componentType?"icon-caret":"icon-arrow";S=t().createElement("i",{className:(a===r.id?" selected ":"")+(r.open?" wasabi-tree-li-icon  ".concat(B,"-down "):" wasabi-tree-li-icon  ".concat(B,"-right")),onClick:r.isParent?v.bind(this,!r.open,r.id,r.text,r):null},t().createElement("span",{className:"wasabi-tree-li-icon-beforeRight"}),t().createElement("span",{className:"wasabi-tree-li-icon-afterBelow",style:{height:(N+1)*R+(r.isLast?-30:0)}}))}return"checkbox"===s?O=t().createElement(A,{key:"c1",hide:!l&&!r.selectAble,half:r.half,name:"node"+r.id,className:(a===r.id?" selected ":"")+(N>0?" hasChildren ":"  "),value:r.checked?r.id:"",data:[{value:r.id,text:""}],onSelect:f.bind(this,r.id,r.text,r)}):"radio"===s?O=t().createElement(F,{key:"r1",hide:!l&&!r.selectAble,half:r.half,name:"node"+r.id,className:(a===r.id?" selected ":"")+(N>0?" hasChildren ":"  "),value:r.checked?r.id:"",data:[{value:r.id,text:""}],onSelect:f.bind(this,r.id,r.text,r)}):"function"==typeof s&&r.selectAble&&(O=s(r)),O&&(E+=20),t().createElement("li",{className:"wasabi-tree-li",key:r.id,style:{display:r.hide?"none":"flex"}},I,r.isParent?S:t().createElement("i",{className:(a===r.id?" selected ":"")+" wasabi-tree-li-icon-line"},t().createElement("span",{className:"wasabi-tree-li-icon-afterBelow",style:{height:(N+1)*R+(r.isLast?-30:0)}})),O,t().createElement("div",{id:r.nodeid,style:{width:"calc(100% - ".concat(E,"px)")},className:a===r.id?"wasabi-tree-li-node selected":"wasabi-tree-li-node",title:w,onDrop:m,onDragOver:b,onDragLeave:k,onClick:p.bind(this,r.id,r.text,r),onDoubleClick:u.bind(this,r.id,r.text,r)},h?t().createElement(_,{id:r.textid,required:!0,onKeyUp:x,onBlur:D,name:"key"+r.id,value:r.text}):t().createElement("div",{key:"2",className:"wasabi-tree-li-node-text-div",draggable:r.draggAble,onDragEnd:y,onDragStart:g},t().createElement("i",{key:"3",className:(!r.selectAble&&N?" noCheckhasChildren ":"  ")+C+" wasabi-tree-text-icon"}),t().createElement("a",{href:r.href,className:"wasabi-tree-txt"},r.text)),!h&&c?t().createElement("i",{key:"edit",className:"icon-edit edit",title:"重命名",onClick:e.beforeNodeRename}):null,!h&&d?t().createElement("i",{key:"delete",className:"icon-xx edit",title:"删除",onClick:e.beforeNodeRemove}):null))}var M=function(e){d(c,e);var o,a,i=(o=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(o);if(a){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function c(e){var t;return r(this,c),(t=i.call(this,e)).treeNodesRef=[],t.state={rename:!1,nodeid:x.uuid(),textid:x.uuid()},t.onBlur=t.onBlur.bind(s(t)),t.onKeyUp=t.onKeyUp.bind(s(t)),t.onNodeRename=t.onNodeRename.bind(s(t)),t.beforeNodeRename=t.beforeNodeRename.bind(s(t)),t.beforeNodeRemove=t.beforeNodeRemove.bind(s(t)),t.onNodeDragEnd=t.onNodeDragEnd.bind(s(t)),t.onNodeDragLeave=t.onNodeDragLeave.bind(s(t)),t.onNodeDragOver=t.onNodeDragOver.bind(s(t)),t.onNodeDragStart=t.onNodeDragStart.bind(s(t)),t.onNodeDrop=t.onNodeDrop.bind(s(t)),t}return l(c,[{key:"onBlur",value:function(e){var t=this.state.text;this.setState({text:e.trim(),rename:!1},this.onNodeRename(t,e.trim()))}},{key:"beforeNodeRename",value:function(){var e=this,t=new V;for(var n in t)t[n]=null!=this.props[n]&&null!=this.props[n]?this.props[n]:t[n];var r=!0;this.props.beforeRename&&(r=this.props.beforeRename(t.id,t.text,t)),r&&this.setState({rename:!!r},(function(){var t=document.getElementById(e.state.textid);t&&t.focus()}))}},{key:"onKeyUp",value:function(e){var t=this.props.text;13==e.keyCode&&this.setState({rename:!1,text:e.target.value.trim()},this.onNodeRename(t,e.target.value.trim()))}},{key:"onNodeRename",value:function(e,t){var n=new V;for(var r in n)n[r]=null!=this.props[r]&&null!=this.props[r]?this.props[r]:n[r];this.props.onRename&&this.props.onRename(n.id,e,n,t)}},{key:"beforeNodeRemove",value:function(e){var t=!0,n=new V;for(var r in n)n[r]=null!=this.props[r]&&null!=this.props[r]?this.props[r]:n[r];this.props.beforeRemove&&(t=this.props.beforeRemove(n.id,n.text,n)),t&&this.props.onRemove&&this.props.onRemove(n.id,n.text,n)}},{key:"onNodeDragStart",value:function(e){if(e.preventDefault(),this.props.draggAble){var t=new V;for(var n in t)t[n]=null!=this.props[n]&&null!=this.props[n]?this.props[n]:t[n];var r=!0;this.props.beforeDrag&&(r=this.props.beforeDrag((t.id,t.text,t))),r&&(e.dataTransfer.setData("drag",JSON.stringify(t)),window.localStorage.setItem("wasabi-drag-item",JSON.stringify(t)),this.props.onDrag&&this.props.onDrag(drag.id,drag.text,t))}}},{key:"onNodeDragEnd",value:function(e){e.preventDefault()}},{key:"onNodeDragOver",value:function(e){if(e.preventDefault(),this.props.dropAble){var t=document.getElementById(this.state.nodeid).getBoundingClientRect().top,n=e.clientY;n-t<10?(document.getElementById(this.state.nodeid).style.borderTop="1px solid var(--border-color)",document.getElementById(this.state.nodeid).style.borderBottom="none",document.getElementById(this.state.nodeid).style.backgroundColor=null,window.localStorage.setItem("wasabi-drag-type","before")):n-t<30?(document.getElementById(this.state.nodeid).style.borderTop="none",document.getElementById(this.state.nodeid).style.borderBottom="none",document.getElementById(this.state.nodeid).style.backgroundColor="var(--background-color)",window.localStorage.setItem("wasabi-drag-type","in")):(document.getElementById(this.state.nodeid).style.borderTop="none",document.getElementById(this.state.nodeid).style.borderBottom="1px solid var(--border-color)",document.getElementById(this.state.nodeid).style.backgroundColor=null,window.localStorage.setItem("wasabi-drag-type","after"))}}},{key:"onNodeDragLeave",value:function(e){e.preventDefault(),document.getElementById(this.state.nodeid).style.borderTop="none",document.getElementById(this.state.nodeid).style.borderBottom="none",document.getElementById(this.state.nodeid).style.backgroundColor=null}},{key:"onNodeDrop",value:function(e){e.preventDefault(),document.getElementById(this.state.nodeid).style.borderTop="none",document.getElementById(this.state.nodeid).style.borderBottom="none",document.getElementById(this.state.nodeid).style.backgroundColor=null;var t=JSON.parse(e.dataTransfer.getData("drag")),n=window.localStorage.getItem("wasabi-drag-type");if(t&&this.props.dropAble){var r=new V;for(var o in r)r[o]=null!=this.props[o]&&null!=this.props[o]?this.props[o]:r[o];var a=!0;this.props.beforeDrop&&(a=this.props.beforeDrop(t,r,n)),a&&(window.localStorage.removeItem("wasabi-drag-type"),this.props.onDrop&&this.props.onDrop(t,r,n))}}},{key:"render",value:function(){return t().createElement(L,n({},this.props,this.state,{onNodeExpand:this.onNodeExpand,onBlur:this.onBlur,onKeyUp:this.onKeyUp,beforeNodeRename:this.beforeNodeRename,onNodeRename:this.onNodeRename,beforeNodeRemove:this.beforeNodeRemove,onNodeEdit:this.onNodeEdit,onNodeDragEnd:this.onNodeDragEnd,onNodeDragLeave:this.onNodeDragLeave,onNodeDragOver:this.onNodeDragOver,onNodeDragStart:this.onNodeDragStart,onNodeDrop:this.onNodeDrop}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.text!=t.oldPropsText)return{text:e.text}}}]),c}(e.Component);M.propTypes={isParent:v().bool,id:v().oneOfType([v().number,v().string]).isRequired,text:v().oneOfType([v().number,v().string]).isRequired,title:v().string,arrowFoldIcon:v().node,arrowUnFoldIcon:v().node,iconCls:v().string,iconClose:v().string,iconOpen:v().string,open:v().bool,checked:v().bool,selectAble:v().bool,draggAble:v().bool,dropAble:v().bool,href:v().string,hide:v().bool,children:v().array,onClick:v().func,onDoubleClick:v().func,onCheck:v().func,onCollapse:v().func,onExpand:v().func,onRename:v().func,onRemove:v().func,onRightClick:v().func,onDrag:v().func,onDrop:v().func,beforeDrag:v().func,beforeDrop:v().func,beforeRemove:v().func,beforeRename:v().func,beforeRightClick:v().func},M.defaultProps={iconCls:"icon-text",iconClose:"icon-folder",iconOpen:"icon-folder-open",checked:!1,selectAble:!1,open:!0,half:!1,draggAble:!1,dropAble:!1,children:[]};const U=M;function H(e){var r=[],o={componentType:e.componentType,selectAble:e.selectAble,checkStyle:e.checkStyle,renameAble:e.renameAble,removeAble:e.removeAble,asyncAble:e.asyncAble,clickId:e.clickId,loadingId:e.loadingId},a={beforeDrag:e.beforeDrag,beforeRemove:e.beforeRemove,beforeDrop:e.beforeDrop,beforeRename:e.beforeRename,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onChecked:e.onChecked,onRemove:e.onRemove,onExpand:e.onExpand,onRename:e.onRename,onDrop:e.onDrop,onDrag:e.onDrag},i=e.visibleData;return i instanceof Array&&i.length>0&&i.map((function(e,i){var l=!1;(1==e.isParent||e.children instanceof Array&&e.children.length>0)&&(l=!0),r.push(t().createElement(U,n({key:"treenode-"+e.id||0},o,e,{isParent:l},a)))})),t().createElement("ul",{id:e.treeid,className:"wasabi-tree clearfix "+(!1===e.dotted?" nodotted ":"")},r)}const Y=t().memo(H);var $=function(e){d(c,e);var o,a,i=(o=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(o);if(a){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return u(this,e)});function c(e){var n;return r(this,c),(n=i.call(this,e)).treegrid=t().createRef(),n.pivot=t().createRef(),n.state={treecontainerid:x.uuid(),treeid:x.uuid(),rawData:[],data:[],visibleData:[],filterValue:"",filter:[],clickId:"",loadingId:"",reVirualConfig:!1},n.onClick=n.onClick.bind(s(n)),n.onDoubleClick=n.onDoubleClick.bind(s(n)),n.onChecked=n.onChecked.bind(s(n)),n.onExpand=n.onExpand.bind(s(n)),n.onRename=n.onRename.bind(s(n)),n.onRemove=n.onRemove.bind(s(n)),n.onDrop=n.onDrop.bind(s(n)),n.onScroll=n.onScroll.bind(s(n)),n.getChecked=n.getChecked.bind(s(n)),n.setChecked=n.setChecked.bind(s(n)),n.clearChecked=n.clearChecked.bind(s(n)),n.checkedAll=n.checkedAll.bind(s(n)),n.setClick=n.setClick.bind(s(n)),n.remove=n.remove.bind(s(n)),n.filter=x.throttle(n.filter.bind(s(n)),300).bind(s(n)),n.append=n.append.bind(s(n)),n.adjust=n.adjust.bind(s(n)),n}return l(c,[{key:"onClick",value:function(e,t,n){try{var r,o,a,i,l,s;this.setState({clickId:e}),null===(r=this.treegrid)||void 0===r||null===(o=r.current)||void 0===o||null===(a=o.grid)||void 0===a||a.current.setFocus(e),null===(i=this.pivot)||void 0===i||null===(l=i.current)||void 0===l||null===(s=l.grid)||void 0===s||s.current.setFocus(e),this.props.onClick&&this.props.onClick(e,t,n)}catch(e){}}},{key:"onDoubleClick",value:function(e,t,n){this.props.onDoubleClick&&this.props.onDoubleClick(e,t,n)}},{key:"onChecked",value:function(e,t,n,r){var o=e+""==r+"",a=[];"checkbox"===this.props.checkStyle?(a=O.setChecked(this.state.data,n,o,this.props.checkType),this.handlerLoadData(a)):"radio"===this.props.checkStyle&&(a=O.setRadioChecked(this.state.data,n,o,this.props.radioType),this.handlerLoadData(a)),this.props.onChecked&&this.props.onChecked(o,e,t,n)}},{key:"onExpand",value:function(e,t,n,r){var o=O.setOpen(this.state.data,r);if(!this.props.asyncAble||r.children&&0!=r.children.length)this.handlerLoadData(o);else{var a=[];if(this.props.onAsync&&"function"==typeof this.props.onAsync)this.setState({loadingId:t}),(a=this.props.onAsync(t,n,r))&&a instanceof Array&&a.length>0&&(a=formatterData("tree","",a,this.props.idField||"id",this.props.textField||"text",this.props.parentField||"pId",!0),o=O.appendChildren(o,r,a),this.handlerLoadData(o));else if(this.props.url){window.sessionStorage.setItem("async-tree-node",JSON.stringify(r)),(x.clone(this.props.params)||{})[this.props.idField||"id"]=t;var i={type:this.props.httpType||"post",url:this.props.url,success:this.loadSuccess,data:this.props.params,error:this.loadError};i.headers=this.props.httpHeaders,i.contentType=this.props.contentType;var l=window.api||E();this.setState({loadingId:t,data:o}),l.ajax(i),console.log("tree async-fetch",i)}}this.props.onExpand&&this.props.onExpand(e,t,n,r)}},{key:"onRename",value:function(e,t,n,r){var o=O.renameNode(this.state.data,n,r);this.handlerLoadData(o),this.props.onRename&&this.props.onRename(e,t,n,r)}},{key:"onRemove",value:function(e,t,n){var r=this;window.confirm("您确定删除["+t+"]吗？",(function(){var o=O.removeNode(r.state.data,n);r.handlerLoadData(o),r.props.onRemove&&r.props.onRemove(e,t,n)}))}},{key:"onDrop",value:function(e,t,n){if(e.id!==t.id){var r=[];if("in"==n){if(e.pId===t.id)return;r=O.moveInNode(this.state.data,e,t)}else"before"==n?r=O.moveBeforeNode(this.state.data,e,t):"after"==n&&(r=O.moveAterNode(this.state.data,e,t));this.handlerLoadData(r)}}},{key:"getChecked",value:function(){return O.getChecked(this.state.data)}},{key:"setChecked",value:function(e,t){if(e){var n=O.findNodeById(this.state.data,e);return n&&(n.checked=t),"checkbox"===this.props.checkStyle?data=O.setChecked(this.state.data,n,t,this.props.checkType):"radio"===this.props.checkStyle&&(data=O.setRadioChecked(this.state.data,n,t,this.props.radioType)),this.handlerLoadData(this.state.data),n}return null}},{key:"clearChecked",value:function(){var e=O.clearChecked(this.state.data);return this.handlerLoadData(e),e}},{key:"checkedAll",value:function(){if("checkbox"===this.props.checkStyle){var e=O.checkedAll(this.state.data);return this.handlerLoadData(e),e}}},{key:"setClick",value:function(e){var t,n,r,o,a,i;if(!O.findNodeById(this.state.visibleData,e)){var l=this.state.flatData.findIndex((function(t){return t.id===e}));this.scrollShowVisibleData(l,l+this.visibleDataCount)}this.setState({clickId:e},(function(){})),null===(t=this.pivot)||void 0===t||null===(n=t.current)||void 0===n||null===(r=n.grid)||void 0===r||r.current.setFocus(e),null===(o=this.treegrid)||void 0===o||null===(a=o.current)||void 0===a||null===(i=a.grid)||void 0===i||i.current.setFocus(e)}},{key:"remove",value:function(e){if(e&&e._path){var t=O.removeNode(this.state.data,e);this.handlerLoadData(t),this.props.onRemove&&this.props.onRemove(e.id,e.text,e)}else if(e.id){var n=O.findNodeById(this.state.data,e.id),r=O.removeNode(this.state.data,n);this.handlerLoadData(r),this.props.onRemove&&this.props.onRemove(e.id,e.text,e)}}},{key:"filter",value:function(e){this.handlerLoadData(this.state.data,e)}},{key:"append",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e&&e.length>0){var n=O.appendChildren(this.state.data,e,t);this.handlerLoadData(n)}}},{key:"adjust",value:function(){try{var e=document.getElementById(this.state.treecontainerid).clientHeight||window.innerHeight;this.visibleDataCount=Math.ceil(e/R),this.onScroll()}catch(e){console.log("ee",e)}}},{key:"handlerLoadData",value:function(e,t){var n=O.filter(e,t||this.state.filterValue),r=x.treeDataToFlatData(this.state.filterValue?n:e),o=r.slice(this.sliceBeginIndex,this.sliceEndIndex),a=O.setVisibleDataProps(o,this.state.data);this.setState({filter:n,data:e,flatData:r,sliceData:o,visibleData:a,loadingId:null})}},{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){this.state.reVirualConfig&&this.visibleDataInit()}},{key:"visibleDataInit",value:function(){var e=document.getElementById(this.state.treecontainerid).clientHeight||window.innerHeight;this.visibleDataCount=Math.ceil(e/R),document.getElementById(this.state.treecontainerid).scrollTop=0,document.getElementById(this.state.treeid).style.transform="translate3d(0,0,0)",this.scrollShowVisibleData(0,this.visibleDataCount)}},{key:"onScroll",value:function(){var e=document.getElementById(this.state.treecontainerid).scrollTop,t=Math.floor(e/R),n=t+1*this.visibleDataCount;this.scrollShowVisibleData(t,n)}},{key:"scrollShowVisibleData",value:function(e,t){var n;if(e>=1){var r=(e+1)*R-(e-1*this.visibleDataCount>=0?(e-1*this.visibleDataCount)*R:0);n=e*R-r}else n=0;document.getElementById(this.state.treeid).style.transform="translate3d(0,".concat(n,"px,0)"),this.sliceBeginIndex=e-1*this.visibleDataCount,this.sliceBeginIndex=this.sliceBeginIndex<0?0:this.sliceBeginIndex,this.sliceEndIndex=t+1*this.visibleDataCount;var o=this.state.flatData.slice(this.sliceBeginIndex,this.sliceEndIndex),a=O.setVisibleDataProps(o,this.state.data);this.setState({visibleData:a,reVirualConfig:!1})}},{key:"loadError",value:function(e){console.log("combobox-error",e),this.setState({loadingId:""}),console.error(e)}},{key:"loadSuccess",value:function(e){if("function"==typeof this.props.loadSuccess){var t=this.props.loadSuccess(e);e=t&&t instanceof Array?t:e}var n=x.getSource(e,this.props.dataSource||"data"),r=window.sessionStorage.getItem("async-tree-node");r=JSON.parse(r);var o=formatterData("tree","",n,this.props.idField||"id",this.props.textField||"text",this.props.parentField||"pId",!0),a=this.state.data;if(nodes=O.findLinkNodesByPath(a,r._path),nodes&&nodes.length>0){var i=nodes[nodes.length-1];i.children=o,O.setChildrenPath(i.id,i._path,i.children)}this.handlerLoadData(a)}},{key:"shouldComponentUpdate",value:function(e,t){return!!x.diff(e,this.props,!1)||!!x.diff(t,this.state,!1)}},{key:"render",value:function(){var e,r={beforeDrag:this.props.beforeDrag,beforeRemove:this.props.beforeRemove,beforeDrop:this.props.beforeDrop,beforeRename:this.props.beforeRename,onClick:this.onClick,onDoubleClick:this.onDoubleClick,onChecked:this.onChecked,onRemove:this.onRemove,onExpand:this.onExpand,onRename:this.onRename,onDrop:this.onDrop,onDrag:this.props.onDrag};return"tree"===this.props.componentType?e=t().createElement(Y,n({},this.props,this.state,r)):this.props.componentType,t().createElement("div",{id:this.state.treecontainerid,onScroll:this.onScroll,className:"wasabi-tree-parent "+(this.props.className||""),style:this.props.style},e,t().createElement("div",{style:{left:0,top:0,height:this.state.flatData&&this.state.flatData.length*R,position:"absolute",width:1}}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n={};if(e.data&&e.data instanceof Array&&x.diff(e.data,t.rawData)){n.rawData=e.data;var r=x.treeDataToFlatData(e.data);return n.data=x.clone(e.data),n.flatData=r,n.reVirualConfig=!0,n}return null}}]),c}(e.Component);$.propTypes={componentType:v().oneOf(["tree","treegrid","pivot"]),name:v().string,idField:v().string,parentField:v().string,textField:v().string,dotted:v().bool,url:v().string,params:v().object,dataSource:v().string,headers:v().array,data:v().array,simpleData:v().bool,selectAble:v().bool,checkStyle:v().oneOf(["checkbox","radio",v().func]),checkType:v().object,radioType:v().oneOf(["level","all"]),renameAble:v().bool,removeAble:v().bool,asyncAble:v().bool,onClick:v().func,onDoubleClick:v().func,onCheck:v().func,onExpand:v().func,onRename:v().func,onRemove:v().func,onRightClick:v().func,onDrag:v().func,onDrop:v().func,onAsync:v().func,beforeDrag:v().func,beforeDrop:v().func,beforeRemove:v().func,beforeRename:v().func,beforeRightClick:v().func},$.defaultProps={componentType:"tree",idField:"id",parentField:"pId",textField:"text",dataSource:"data",dotted:!0,simpleData:!0,selectAble:!0,checkStyle:"checkbox",checkType:{y:"ps",n:"ps"},radioType:"all"};const q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"value",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"text",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"pId",i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!n)return n;var l=x.clone(n);if(l&&l instanceof Array&&l.length>0)for(var s=0;s<l.length;s++)"tree"==e||"treepicker"==e||"treegrid"==e?l[s].id=l[s].id||l[s][r]:l[s].value=l[s].value||l[s][r],l[s].text=l[s].text||l[s][o],t&&(","+t+",").indexOf(","+("tree"==e||"treepicker"==e?l[s].id:l[s].value)+",")>-1&&(l[s].checked=!0),l[s].children&&l[s].children.length>0&&(l[s].children=propsTran.formatterData(e,t,l[s].children,r,o,a,i));return"tree"!==e&&"treepicker"!==e&&"treegrid"!==e||!i||(l=x.toTreeData(l,r,a,o)),l};function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}const J=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"select",a=function(a){d(c,a);var i=K(c);function c(e){var n;return r(this,c),(n=i.call(this,e)).input=t().createRef(),n.state={url:null,params:null,rawParams:null,rawData:[],data:[],filterText:"",filterData:[],loadDataStatus:null,idField:n.props.idField,valueField:n.props.valueField,textField:n.props.textField},n.handlerData=n.handlerData.bind(s(n)),n.getValue=n.getValue.bind(s(n)),n.setValue=n.setValue.bind(s(n)),n.reload=n.reload.bind(s(n)),n.loadData=n.loadData.bind(s(n)),n.loadSuccess=n.loadSuccess.bind(s(n)),n.loadError=n.loadError.bind(s(n)),n}return l(c,[{key:"componentDidMount",value:function(){this.handlerData()}},{key:"componentDidUpdate",value:function(){this.handlerData()}},{key:"handlerData",value:function(){if("url"===this.state.loadDataStatus)this.loadData();else if("data"===this.state.loadDataStatus){var e="tree"==o||"treegrid"===o||"treepicker"===o?this.props.idField||"id":this.props.valueField||"value",t=q(o,this.getValue(),this.state.rawData,e,this.props.textField||"text");this.setState({data:t,loadDataStatus:null})}}},{key:"loadData",value:function(){if(this.state.url){var e={type:this.props.httpType||"post",url:this.state.url,success:this.loadSuccess,data:this.state.params,error:this.loadError};e.headers=this.props.httpHeaders,e.contentType=this.props.contentType,(window.api||E()).ajax(e),console.log("combobox-fetch",e)}}},{key:"loadError",value:function(e){console.log("combobox-error",e),Msg.error(e)}},{key:"loadSuccess",value:function(e){if("function"==typeof this.props.loadSuccess){var t=this.props.loadSuccess(e);e=t&&t instanceof Array?t:e}var n=x.getSource(e,this.props.dataSource||"data"),r="tree"==o||"treegrid"===o||"treepicker"===o?this.props.idField:this.props.valueField,a=q(o,this.getValue(),n,r,this.props.textField);this.setState({loadDataStatus:null,rawData:n,data:a})}},{key:"setValue",value:function(e){this.input.current&&this.input.current.setValue&&this.input.current.setValue(e)}},{key:"getValue",value:function(){return this.input.current&&this.input.current.getValue&&this.input.current.getValue()}},{key:"reload",value:function(e,t){this.input.current.reload?this.input.current.reload():(t=t||this.props.url,e=e||this.state.params,this.setState({loadDataStatus:"url",params:e}))}},{key:"shouldComponentUpdate",value:function(e,t){return!!x.diff(e,this.props,!1)||!!x.diff(t,this.state,!1)}},{key:"render",value:function(){return t().createElement(e,n({},this.props,{componentType:o,ref:this.input,reload:this.reload,data:this.state.filterText?this.state.filterData:this.state.data}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n={};return e.data&&e.data instanceof Array&&x.diff(e.data,t.rawData)?(n={loadDataStatus:"data"}).rawData=e.data:(e.url&&e.url!=t.url||x.diff(e.params,t.rawParams))&&(n={loadDataStatus:"url",url:e.url,rawParams:x.clone(e.params),params:x.clone(e.params)}),n}}]),c}(t().Component);return a}($,"tree")})(),i})()}));